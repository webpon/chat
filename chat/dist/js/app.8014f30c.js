(function(t){function e(e){for(var s,r,c=e[0],i=e[1],u=e[2],f=0,m=[];f<c.length;f++)r=c[f],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&m.push(a[r][0]),a[r]=0;for(s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);l&&l(e);while(m.length)m.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],s=!0,c=1;c<n.length;c++){var i=n[c];0!==a[i]&&(s=!1)}s&&(o.splice(e--,1),t=r(r.s=n[0]))}return t}var s={},a={app:0},o=[];function r(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=s,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=i;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},"038b":function(t,e,n){},"0973":function(t,e,n){"use strict";n("3fbc")},"0a93":function(t,e,n){"use strict";n("f0e8")},1386:function(t,e,n){},1504:function(t,e,n){"use strict";n("43ad")},"39b2":function(t,e,n){},"3cb9":function(t,e,n){"use strict";n("6031")},"3cda":function(t,e,n){t.exports=n.p+"img/message_hover.cf2760d7.png"},"3d81":function(t,e,n){t.exports=n.p+"img/1.b34e0a9d.jpg"},"3fbc":function(t,e,n){},"43ad":function(t,e,n){},4535:function(t,e,n){"use strict";n("038b")},4614:function(t,e,n){t.exports=n.p+"img/10.e2a01d19.jpg"},4678:function(t,e,n){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function a(t){var e=o(t);return n(e)}function o(t){if(!n.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}a.keys=function(){return Object.keys(s)},a.resolve=o,t.exports=a,a.id="4678"},"487d":function(t,e,n){t.exports=n.p+"img/0.864a6a4d.jpg"},"50ad":function(t,e,n){t.exports=n.p+"img/contacts.88d3e262.png"},"52a8":function(t,e,n){},"5692d":function(t,e,n){t.exports=n.p+"img/15.47216105.jpg"},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("keep-alive",[n("router-view")],1)],1)},o=[],r=(n("159b"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"container"},[n("div",{staticClass:"asider_container"},[n("asiderNav")],1),n("div",{staticClass:"content_container"},[n("keep-alive",[n("router-view")],1)],1)])])}),c=[],i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"navContainer"},[s("div",{staticClass:"avaterContainer",on:{click:t.showMyInfo}},[s("img",{attrs:{src:t.myInfo.imgSrc,alt:"webpon"}})]),s("navItem",{attrs:{path:"/chat"}},[s("img",{attrs:{slot:"item-icon",src:n("6599"),alt:""},slot:"item-icon"}),s("img",{attrs:{slot:"item-icon-active",src:n("3cda"),alt:""},slot:"item-icon-active"})]),s("navItem",{attrs:{path:"/contacts"},nativeOn:{click:function(e){return t.getOnlineUserInfo(e)}}},[s("img",{attrs:{slot:"item-icon",src:n("50ad"),alt:""},slot:"item-icon"}),s("img",{attrs:{slot:"item-icon-active",src:n("bd6f")},slot:"item-icon-active"})]),s("a-dropdown",{staticClass:"logoutCon",scopedSlots:t._u([{key:"overlay",fn:function(){return[s("a-menu",{staticClass:"logoutItem",attrs:{slot:"overlay"},slot:"overlay"},[s("a-menu-item",[s("a",{attrs:{href:"javascript:;"}},[t._v("个人信息")])]),s("a-menu-item",{on:{click:t.logout}},[s("a",{attrs:{href:"javascript:;"}},[t._v("注销")])])],1)]},proxy:!0}])},[s("a",{staticClass:"ant-dropdown-link",on:{click:function(t){return t.preventDefault()}}},[s("a-icon",{staticClass:"logout",attrs:{type:"import"}})],1)])],1)},u=[],l=(n("5319"),n("ac1f"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tab-bar-item",on:{click:t.itemClick}},[t.isActive?n("div",[t._t("item-icon-active")],2):n("div",[t._t("item-icon")],2)])}),f=[],m={name:"TabBaritem",data:function(){return{a:"true"}},props:{path:String},computed:{isActive:function(){return-1!==this.$route.path.indexOf(this.path)}},methods:{itemClick:function(){console.log(this.path),this.$router.replace(this.path)}},created:function(){console.log(this.$route.path)}},d=m,p=(n("d4e2"),n("2877")),h=Object(p["a"])(d,l,f,!1,null,"8454d2e6",null),g=h.exports,b={name:"navContainer",data:function(){return{}},components:{navItem:g},computed:{myInfo:function(){return this.$store.state.myInfo}},created:function(){},methods:{logout:function(){localStorage.removeItem("token"),localStorage.removeItem("myInfo"),this.$socket.close(),this.$router.replace("/login")},getOnlineUserInfo:function(){this.$socket.emit("getOnlineUserInfo",JSON.parse(localStorage.myInfo).username)},showMyInfo:function(){alert("You are "+JSON.parse(localStorage.myInfo).username)}}},v=b,j=(n("76e3"),Object(p["a"])(v,i,u,!1,null,"28de938a",null)),y=j.exports,k={name:"layout",data:function(){return{}},components:{asiderNav:y},created:function(){},methods:{},mounted:function(){}},_=k,x=(n("4535"),Object(p["a"])(_,r,c,!1,null,"3e79ce65",null)),$=x.exports,I=n("f64c"),C={name:"App",components:{Layout:$},data:function(){return{}},computed:{path:function(){return this.$route.path}},mounted:function(){var t=this;console.log("APPmounted"),localStorage.token&&"/login"!==this.path&&this.$socket.disconnected&&(this.$socket.open(),this.$socket.on("sendList",(function(e){t.contacts=e,console.log(e),t.$store.commit("updateContacts",e),console.log(t.$store.state.contacts)}))),this.$socket.on("emitEvent",(function(e){var n;console.log(e),"群聊"===e.to?I["a"].info(e.from+"向群聊发送了一条消息"):(I["a"].info(e.from+"向你发来一条消息"),console.log(t.$store.state.contacts),t.$store.state.contacts.forEach((function(t){console.log(t),t.username===e.from&&(console.log(t),n=t.imgSrc)})),t.bus.$emit("chatUser",{username:e.from,imgSrc:n}),console.log({username:e.from,imgSrc:n})),t.$store.commit("addMsg",e)}))},beforeDestroy:function(){console.log("beforeDestroy"),this.$socket.off("emitEvent")},watch:{path:function(t,e){"/login"!==this.path&&this.$socket.open()}}},w=C,O=(n("034f"),Object(p["a"])(w,a,o,!1,null,null,null)),S=O.exports,E=n("8c4f"),N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"LoginCard",staticStyle:{background:"#ECECEC",padding:"50px"}},[n("a-card",{staticClass:"card",attrs:{title:"登录/注册",bordered:!1,hoverable:!0}},[n("a-form-model",{ref:"ruleForm",staticClass:"cardForm",attrs:{layout:"vertical",model:t.model,"wrapper-col":{span:24},rules:t.rules}},[n("a-form-model-item",{attrs:{label:"用户名",prop:"username"}},[n("a-input",{attrs:{size:"large"},model:{value:t.model.username,callback:function(e){t.$set(t.model,"username","string"===typeof e?e.trim():e)},expression:"model.username"}})],1),n("a-form-model-item",{attrs:{label:"密码",prop:"password"}},[n("a-input",{attrs:{type:"password",size:"large"},on:{pressEnter:function(e){return t.login("ruleForm")}},model:{value:t.model.password,callback:function(e){t.$set(t.model,"password","string"===typeof e?e.trim():e)},expression:"model.password"}})],1),n("a-form-model-item",{staticClass:"formBtn"},[n("a-space",{attrs:{size:80}},[n("a-button",{attrs:{size:"large"},on:{click:function(e){return t.register("ruleForm")}}},[t._v("注册")]),n("a-button",{attrs:{type:"primary",size:"large"},on:{click:function(e){return t.login("ruleForm")}}},[t._v("登录")])],1)],1)],1)],1),n("div",{ref:"avaterSelector",staticClass:"avaterSelector"},[n("h3",{staticClass:"avaterTitle"},[t._v("请选择你的头像")]),t._l(t.imgArr,(function(e,s){return n("div",{key:s,staticClass:"imgContainer"},[n("img",{ref:"avater",refInFor:!0,staticClass:"imgItem",attrs:{src:e,alt:""},on:{"~click":function(e){return t.selectAvater(s)}}})])})),n("button",{staticClass:"avaterBtn",on:{click:function(e){return t.avaterRegister()}}},[t._v("选好了")])],2)],1)},z=[],R=n("1da1"),B=(n("96cf"),[n("487d"),n("3d81"),n("a2d4"),n("92b3"),n("7ae1"),n("e117"),n("d46a"),n("8f2d"),n("f709"),n("8525"),n("4614"),n("c772"),n("d3de"),n("7daf"),n("84a3"),n("5692d")]),M={name:"Login",data:function(){var t=function(t,e,n){""===e?n(new Error("请输入用户名")):n()},e=function(t,e,n){""===e?n(new Error("请输入密码")):n()};return{model:{username:"",password:""},rules:{username:[{validator:t,trigger:"change"}],password:[{validator:e,trigger:"change"},{min:5,max:40,message:"密码长度为5-40",trigger:"change"}]},formName:null,imgUrl:"../../assets/avater/0.jpg"}},computed:{imgArr:function(){return B}},methods:{register:function(t){var e=this;return Object(R["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$refs[t].validate(function(){var n=Object(R["a"])(regeneratorRuntime.mark((function n(s){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:s&&(e.$refs.avaterSelector.style.visibility="visible",e.$refs.avaterSelector.style.top="50%",e.formName=t);case 1:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}());case 1:case"end":return n.stop()}}),n)})))()},login:function(t){var e=this;return Object(R["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$refs[t].validate(function(){var t=Object(R["a"])(regeneratorRuntime.mark((function t(n){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n){t.next=14;break}return console.log(e.model),console.log("开始登录"),t.next=5,e.$http.post("login",e.model);case 5:s=t.sent,localStorage.token=s.data.token,I["a"].success("登录成功"),console.log(s),localStorage.setItem("myInfo",JSON.stringify(s.data.userInfo)),e.$store.commit("updateMyInfo",s.data.userInfo),e.$router.replace("/chat"),t.next=16;break;case 14:return e.$message.error("请正确输入"),t.abrupt("return",!1);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return n.stop()}}),n)})))()},selectAvater:function(t){console.log(this.$refs.avater[t]),this.imgUrl="https://gitee.com/gitopenchina/gallery/raw/master/avater/"+t+".jpg",this.$refs.avater[t].style.border="1px solid red"},avaterRegister:function(){var t=this;return Object(R["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log(t.formName),t.$refs[t.formName].validate(function(){var e=Object(R["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$refs[t.formName].validate(function(){var e=Object(R["a"])(regeneratorRuntime.mark((function e(n){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n){e.next=22;break}return e.prev=1,e.next=4,t.$http.post("create",{username:t.model.username,password:t.model.password,imgSrc:t.imgUrl});case 4:return console.log(t.model),e.next=7,t.$http.post("login",t.model);case 7:s=e.sent,localStorage.token=s.data.token,localStorage.setItem("myInfo",JSON.stringify({username:t.model.username,msg:"Hi",imgSrc:t.imgUrl})),t.$store.commit("updateMyInfo",{username:t.model.username,msg:"Hi",imgSrc:t.imgUrl}),t.$message.success("注册成功，并完成自动登录"),t.$router.replace("/chat"),e.next=20;break;case 15:e.prev=15,e.t0=e["catch"](1),t.$message.error("用户名重复，换一个注册吧"),t.$refs.avaterSelector.style.visibility="hiddle",t.$refs.avaterSelector.style.top="-50%";case 20:e.next=26;break;case 22:return t.$message.error("请正确输入"),t.$refs.avaterSelector.style.visibility="hiddle",t.$refs.avaterSelector.style.top="-50%",e.abrupt("return",!1);case 26:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))()}}},J=M,L=(n("f18d"),n("e3c1"),Object(p["a"])(J,N,z,!1,null,"40a18870",null)),T=L.exports,U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("contactsList"),n("chatBackground")],1)},q=[],A=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"contacts"},[n("h3",{staticClass:"contactstitle"},[t._v("在线用户"+t._s(t.contacts.length))]),t._l(t.contacts,(function(t,e){return n("listItem",{key:e,attrs:{contactsInfo:t}})}))],2)},F=[],P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"listItem",class:{active:1==t.isActive},on:{click:t.toChat}},[n("div",{staticClass:"list_avater_container"},[n("img",{key:Math.random(),attrs:{src:t.contactsInfo.imgSrc,alt:""}})]),n("div",{staticClass:"msgContainer"},[n("p",{staticClass:"Title"},[t._v(" "+t._s(t.contactsInfo.username)+" ")])]),n("div")])},D=[],W={name:"",data:function(){return{isActive:!1}},props:{contactsInfo:{type:Object,default:{}}},components:{},methods:{toChat:function(){if(this.contactsInfo.username===JSON.parse(localStorage.myInfo).username)return this.alertWheel.div.add(this.alertWheel.button).add(this.alertWheel.p).show(),void console.log(this.alertWheel.element);console.log(this.contactsInfo),this.bus.$emit("chatUser",this.contactsInfo),this.$router.push({path:"/chat/toChat",query:{userName:this.contactsInfo.username}})}}},V=W,H=(n("58bf"),n("a3a6"),Object(p["a"])(V,P,D,!1,null,"0970ee01",null)),X=H.exports,Y={name:"contactsList",data:function(){return{contacts:[]}},components:{listItem:X},created:function(){var t=this;this.$socket.on("sendList",(function(e){t.contacts=e,console.log(e),t.$store.commit("updateContacts",e),console.log(t.$store.state.contacts)}))},watch:{contacts:function(t,e){}},destroyed:function(){console.log("beforeDestroy"),this.$socket.off("sendList")}},G=Y,K=(n("0973"),Object(p["a"])(G,A,F,!1,null,"5d547b5f",null)),Q=K.exports,Z=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},tt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chatBackground"},[n("div",{staticClass:"bac_title"},[t._v(" 基于Vue+express+Websocket+mongodb实时聊天 ")])])}],et={name:"chatBackground",data:function(){return{}},components:{},created:function(){}},nt=et,st=(n("8c45"),Object(p["a"])(nt,Z,tt,!1,null,"775ba338",null)),at=st.exports,ot={name:"contacts",data:function(){return{}},components:{contactsList:Q,chatBackground:at}},rt=ot,ct=Object(p["a"])(rt,U,q,!1,null,null,null),it=ct.exports,ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"chat_body"}},[n("div",{staticClass:"chatLists"},[n("chatLists")],1),n("transition",{attrs:{name:"custom-classes-transition","enter-active-class":"animate__animated animate__slideInLeft","leave-active-class":"animate__animated animate__slideOutRight"}},[n("router-view")],1)],1)},lt=[],ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"list_warper"},[n("div",{staticClass:"msg_container"},[n("div",{staticClass:"formContainer"},[n("a-input",{attrs:{placeholder:"搜索"}},[n("a-icon",{attrs:{slot:"prefix",type:"search"},slot:"prefix"})],1),n("div",{staticClass:"plus"},[n("a-icon",{attrs:{slot:"prefix",type:"plus"},slot:"prefix"})],1)],1)]),n("div",{staticClass:"listContainer"},t._l(t.userInfo,(function(t,e){return n("div",{key:e},[n("listItem",{attrs:{userInfo:t}})],1)})),0)])},mt=[],dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"listItem",class:{active:1==t.isActive},on:{click:t.toChat}},[n("div",{staticClass:"list_avater_container"},[n("img",{key:Math.random(),attrs:{src:t.userInfo.imgSrc,alt:""}})]),n("div",{staticClass:"msgContainer"},[n("p",{staticClass:"Title"},[t._v(" "+t._s(t.userInfo.username)+" ")]),n("p",{staticClass:"text"},[t._v(t._s(t.userInfo.msg))])]),n("div")])},pt=[],ht={name:"",data:function(){return{isActive:!1}},props:{userInfo:{type:Object,default:[]}},components:{},methods:{toChat:function(){this.$router.push({path:"/chat/toChat",query:{userName:this.userInfo.username}})}}},gt=ht,bt=(n("3cb9"),n("72a3"),Object(p["a"])(gt,dt,pt,!1,null,"4732fbd0",null)),vt=bt.exports,jt={name:"",data:function(){return{userInfo:[{username:"智能客服",msg:"欢迎反馈bug",imgSrc:n("3d81")},{username:"群聊",msg:"在这里可以收到所有人的信息",imgSrc:n("7ae1")}]}},components:{listItem:vt},methods:{active:function(){console.log(1221)}},created:function(){var t=this;this.bus.$on("chatUser",(function(e){var n=!0;t.userInfo.forEach((function(t){console.log(t),t.username!==e.username||(n=!1)})),n&&t.userInfo.push(e)}))},beforeDestroy:function(){this.bus.$off("chatUser"),console.log("beforeDestroy"),this.$socket.off("emitEvent")}},yt=jt,kt=(n("0a93"),n("d816"),Object(p["a"])(yt,ft,mt,!1,null,"55f15aed",null)),_t=kt.exports,xt={name:"chat",data:function(){return{chatCom:"chatBackground"}},components:{chatLists:_t},methods:{}},$t=xt,It=(n("b806"),Object(p["a"])($t,ut,lt,!1,null,"4da5af92",null)),Ct=It.exports,wt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chatCom"},[n("chatTtile"),n("chatBody"),n("chatForm")],1)},Ot=[],St=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chatTitle"},[n("h3",{staticClass:"msg_title"},[n("a-icon",{staticClass:"back",attrs:{type:"left"},on:{click:t.back}}),t._v(" "+t._s(t.$route.query.userName)+" ")],1)])},Et=[],Nt={name:"",data:function(){return{}},components:{},methods:{back:function(){this.$router.push({path:"/chat"})}}},zt=Nt,Rt=(n("6a34"),Object(p["a"])(zt,St,Et,!1,null,"196a7ec7",null)),Bt=Rt.exports,Mt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"chatBodytainer"}},[n("div",{staticClass:"chatBody",attrs:{id:"chatRecord"}},t._l(t.currentMsgInfo,(function(t,e){return n("div",{key:e},[n("msg",{attrs:{msg:t}})],1)})),0)])},Jt=[],Lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"messageWarpper"},[n("img",{attrs:{src:t.imgSrc,alt:""}}),n("span",{staticClass:"nick"},[t._v(t._s(t.sendmsg.from))]),n("span",{staticClass:"msgCard"},[t._v(" "+t._s(t.sendmsg.msg)+" ")])])])},Tt=[],Ut={name:"",data:function(){return{}},components:{},props:{sendmsg:{type:Object,default:{}}},computed:{imgSrc:function(){var t,e=this;return this.$store.state.contacts.forEach((function(n){console.log(n),n.username===e.sendmsg.from&&(console.log(n),t=n.imgSrc)})),t||n("cf05")}}},qt=Ut,At=(n("1504"),Object(p["a"])(qt,Lt,Tt,!1,null,"9ec7776e",null)),Ft=At.exports,Pt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[null!==t.sendmsg?n("div",{staticClass:"messageWarpper"},[n("span",{staticClass:"msgCard"},[t._v(" "+t._s(t.sendmsg.msg)+" ")]),n("img",{attrs:{src:t.myInfo.imgSrc,alt:""}})]):t._e()])},Dt=[],Wt={name:"",data:function(){return{myInfo:this.$store.state.myInfo}},props:{sendmsg:{type:Object,default:{}}},components:{},computed:{},created:function(){}},Vt=Wt,Ht=(n("58ac"),Object(p["a"])(Vt,Pt,Dt,!1,null,"be11eb14",null)),Xt=Ht.exports,Yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.msg.to===t.$route.query.userName&&t.msg.from!==t.$store.state.myInfo.username||t.msg.from===t.$route.query.userName?n("div",[n("messageItem",{attrs:{sendmsg:t.msg}})],1):t.msg.from===t.$store.state.myInfo.username?n("div",[n("sendmessage",{attrs:{sendmsg:t.msg}})],1):t._e()])},Gt=[],Kt={name:"",data:function(){return{myInfo:JSON.parse(localStorage.myInfo)}},props:{msg:{type:Object,default:{}}},components:{messageItem:Ft,sendmessage:Xt}},Qt=Kt,Zt=Object(p["a"])(Qt,Yt,Gt,!1,null,null,null),te=Zt.exports,ee={name:"chatBody",data:function(){return{}},components:{messageItem:Ft,sendmessage:Xt,msg:te},computed:{msgInfo:function(){return this.$store.state.msgInfo},currentMsgInfo:function(){var t=this,e=[];if(null!==this.$store.state.msgInfo)return this.$store.state.msgInfo.forEach((function(n){("群聊"===n.to&&n.to===t.$route.query.userName||n.from===JSON.parse(localStorage.myInfo).username&&n.to===t.$route.query.userName||n.from===t.$route.query.userName&&n.to===JSON.parse(localStorage.myInfo).username)&&e.push(n)})),console.log(e),e},session:function(){return JSON.parse(localStorage.getItem("myInfo"))}},watch:{msgInfo:function(t,e){localStorage.setItem("msgInfo",JSON.stringify(t)),setTimeout((function(){var t=document.querySelector(".chatBody");t.scrollTo(0,t.scrollHeight)}),50)}},updated:function(){}},ne=ee,se=(n("6976"),Object(p["a"])(ne,Mt,Jt,!1,null,"b3e1a38c",null)),ae=se.exports,oe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chatForm"},[n("a-textarea",{attrs:{placeholder:"请输入内容",rows:4},on:{pressEnter:function(e){return e.preventDefault(),t.sendmsg(e)}},model:{value:t.message,callback:function(e){t.message="string"===typeof e?e.trim():e},expression:"message"}}),n("a-button",{staticClass:"sendBtn",on:{click:t.sendmsg}},[t._v("发送")])],1)},re=[],ce={data:function(){return{message:"",msgRecords:[]}},methods:{sendmsg:function(){""!=this.message&&(this.$store.commit("addMsg",{from:JSON.parse(localStorage.myInfo).username,to:this.$route.query.userName,msg:this.message}),console.log(this.$store.state.msgInfo),this.$socket.emit("sendEvent",{from:JSON.parse(localStorage.myInfo).username,to:this.$route.query.userName,msg:this.message}),this.message="")}},mounted:function(){}},ie=ce,ue=(n("6637"),n("7e9a"),Object(p["a"])(ie,oe,re,!1,null,"52aa32b7",null)),le=ue.exports,fe={name:"chatCom",components:{chatTtile:Bt,chatBody:ae,chatForm:le}},me=fe,de=(n("ee12"),Object(p["a"])(me,wt,Ot,!1,null,"197ebec0",null)),pe=de.exports,he=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},ge=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chatBackground"},[n("div",{staticClass:"bac_title"},[t._v(" 基于Vue+express+Websocket+mongodb实时聊天 ")])])}],be={name:"chatBackground",data:function(){return{}},components:{},created:function(){}},ve=be,je=(n("b3ff"),Object(p["a"])(ve,he,ge,!1,null,"7431b955",null)),ye=je.exports;s["a"].use(E["a"]);var ke=[{path:"/",redirect:"/chat"},{path:"/",name:"Layout",component:$,children:[{path:"contacts",name:"contacts",component:it},{path:"chat",name:"chat",component:Ct,children:[{path:"toChat",name:"toChat",component:pe},{path:"",name:"background",component:ye}]}]},{path:"/login",component:T}],_e=new E["a"]({mode:"hash",base:"",routes:ke});_e.beforeEach((function(t,e,n){if("/login"===t.path)n();else{var s=localStorage.token;s?n():n("/login")}}));var xe=_e,$e=n("2f62");s["a"].use($e["a"]);var Ie=new $e["a"].Store({state:{username:"webpon",msgInfo:JSON.parse(localStorage.msgInfo||"null")||null,myInfo:JSON.parse(localStorage.getItem("myInfo")),contacts:[]},mutations:{addMsg:function(t,e){null===t.msgInfo?t.msgInfo=[e]:t.msgInfo.push(e)},updateMyInfo:function(t,e){console.log(e),t.myInfo=e},updateContacts:function(t,e){t.contacts=e}},actions:{},modules:{}}),Ce=(n("77ed"),n("f23d")),we=(n("202f"),n("d3b7"),n("bc3a")),Oe=n.n(we),Se=Oe.a.create({baseURL:"http://106.52.44.186:5000/api/admin"});Se.interceptors.request.use((function(t){return console.log(t),console.log(localStorage.token),localStorage.token&&(console.log("okok"),t.headers.Authorization=localStorage.token),t}),(function(t){return Promise.reject(t)}));var Ee=Se,Ne=n("8e27"),ze=null;ze=Object(Ne["io"])("http://106.52.44.186:5000",{reconnection:!1,autoConnect:!1}),s["a"].prototype.$socket=ze;try{ze.on("connect",(function(){console.log("websocket连接成功"),ze.emit("set",localStorage.myInfo),console.log("重新注册")})),ze.on("disconnect",(function(){if(console.log("websocket断开连接"),localStorage.token)var t=setInterval((function(){ze.open(),console.log("正在尝试重新连接"),ze.connected&&(console.log("重新连接成功"),clearInterval(t))}),5e3)}))}catch(We){console.log("websocket还没连接")}var Re=n("262e"),Be=n("2caf"),Me=n("d4ec"),Je=n("bee2"),Le=function(){function t(){Object(Me["a"])(this,t),this.children=[],this.element=null}return Object(Je["a"])(t,[{key:"init",value:function(){throw new Error("请重写init方法")}},{key:"add",value:function(t){return this.children.push(t),this.element.appendChild(t.element),this}}]),t}(),Te=function(t){Object(Re["a"])(n,t);var e=Object(Be["a"])(n);function n(t,s){var a;return Object(Me["a"])(this,n),a=e.call(this),a.id=t||"get",a.parent=s,a.init(),a}return Object(Je["a"])(n,[{key:"init",value:function(){this.element=document.createElement("div"),this.element.id=this.id,this.element.onclick=function(){this.style.top="-50%"},this.element.style="\n        position: absolute;\n        left: 50%;\n        top: -50%;\n        transform: translate(-50%, -50%);\n        width: 400px;\n        height: 300px;\n        z-index:10000;\n        background-color: #fff;\n        -moz-box-shadow: 10px 10px 5px #888888; /* 老的 Firefox */\n        box-shadow: 0px 0px 10px #888888;\n        transition: all .5s;\n    "}},{key:"show",value:function(){var t=this;this.parent.appendChild(this.element),setTimeout((function(){t.element.style.top="50%"}),30)}}]),n}(Le),Ue=function(){function t(e,n){Object(Me["a"])(this,t),this.id=e||"",this.defaultValue=n||"关闭",this.init()}return Object(Je["a"])(t,[{key:"init",value:function(){this.element=document.createElement("button"),this.element.id=this.id||"search",this.element.innerText=this.defaultValue,this.element.style="\n      position:absolute;\n      left:50%;\n      bottom:40px;\n      transform: translateX(-50%);\n    "}}]),t}(),qe=function(){function t(e,n){Object(Me["a"])(this,t),this.id=e||"",this.defaultValue=n||"",this.init()}return Object(Je["a"])(t,[{key:"init",value:function(){this.element=document.createElement("p"),this.element.id=this.id||"search",this.element.innerText=this.defaultValue,this.element.style="\n      position:absolute;\n      left:50%;\n      bottom:100px;\n      transform: translateX(-50%);\n    "}}]),t}(),Ae=new Te("alertInfo",document.body),Fe=new qe("pp","这是你自己，去找别人聊天吧"),Pe=new Ue("btn"),De={div:Ae,button:Pe,p:Fe};s["a"].prototype.$http=Ee,s["a"].use(Ce["a"]),s["a"].prototype.bus=new s["a"],s["a"].config.productionTip=!1,s["a"].prototype.alertWheel=De,new s["a"]({router:xe,store:Ie,render:function(t){return t(S)}}).$mount("#app")},"58ac":function(t,e,n){"use strict";n("db2c")},"58bf":function(t,e,n){"use strict";n("8978")},5989:function(t,e,n){},"5a7d":function(t,e,n){},6031:function(t,e,n){},"62b4":function(t,e,n){},6599:function(t,e,n){t.exports=n.p+"img/message.95280dc3.png"},6637:function(t,e,n){"use strict";n("88cc")},6976:function(t,e,n){"use strict";n("5989")},"6a34":function(t,e,n){"use strict";n("52a8")},"72a3":function(t,e,n){"use strict";n("62b4")},"76e3":function(t,e,n){"use strict";n("fb77")},"7ae1":function(t,e,n){t.exports=n.p+"img/4.bf8e40f1.jpg"},"7daf":function(t,e,n){t.exports=n.p+"img/13.5fd26779.jpg"},"7e9a":function(t,e,n){"use strict";n("f9de")},"84a3":function(t,e,n){t.exports=n.p+"img/14.5355c506.jpg"},8525:function(t,e,n){t.exports=n.p+"img/9.9607b4e5.jpg"},"85ec":function(t,e,n){},"88cc":function(t,e,n){},8978:function(t,e,n){},"8c45":function(t,e,n){"use strict";n("5a7d")},"8f2d":function(t,e,n){t.exports=n.p+"img/7.2d947d54.jpg"},9019:function(t,e,n){},"92b3":function(t,e,n){t.exports=n.p+"img/3.c04584d9.jpg"},9440:function(t,e,n){},a2d4:function(t,e,n){t.exports=n.p+"img/2.7ef09030.jpg"},a3a6:function(t,e,n){"use strict";n("1386")},b1e1:function(t,e,n){},b3ff:function(t,e,n){"use strict";n("9440")},b806:function(t,e,n){"use strict";n("9019")},bd6f:function(t,e,n){t.exports=n.p+"img/contacts_hover.503879a1.png"},c3e6:function(t,e,n){},c772:function(t,e,n){t.exports=n.p+"img/11.7988802d.jpg"},cf05:function(t,e,n){t.exports=n.p+"img/logo.82b9c7a5.png"},d3de:function(t,e,n){t.exports=n.p+"img/12.5311d023.jpg"},d46a:function(t,e,n){t.exports=n.p+"img/6.c5c6cb06.jpg"},d4e2:function(t,e,n){"use strict";n("fc4f")},d816:function(t,e,n){"use strict";n("c3e6")},db2c:function(t,e,n){},e117:function(t,e,n){t.exports=n.p+"img/5.9c7e4ab3.jpg"},e370:function(t,e,n){},e3c1:function(t,e,n){"use strict";n("b1e1")},ee12:function(t,e,n){"use strict";n("e370")},f0e8:function(t,e,n){},f18d:function(t,e,n){"use strict";n("39b2")},f709:function(t,e,n){t.exports=n.p+"img/8.a25e98ec.jpg"},f9de:function(t,e,n){},fb77:function(t,e,n){},fc4f:function(t,e,n){}});
//# sourceMappingURL=app.8014f30c.js.map